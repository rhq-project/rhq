<?xml version="1.0"?>

<!DOCTYPE html
        PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtResourcesTree.xhtmlml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.ajax4jsf.org/rich"
      xmlns:onc="http://jboss.org/on/component">

 <body>

      <f:view>

         Usage: The following parameters must be set in the calling page

         paginationDataTableName - Name of the data table to be controlled
         paginationDataModel - Data model of the underlying table being controlled (used for total row count)
         paginationPageControl - Page control value to set when changing the number of rows per page

         <ui:composition>

    <h:form> <!-- datascroll tag wants a form to be present -->

        <input type="hidden" name="id" value="#{ResourceGroupUIBean.groupId}"/>

        <a4j:region renderRegionOnly="true">

            <f:facet name="header">
                Server Resources (in single element pages)
            </f:facet>


            <h:form id="leftNavGroupTreeForm">


                    <rich:tree style="width: 100%; height: 100%" switchType="ajax" stateAdvisor="#{ResourceTreeStateAdvisor}"
                               var="treeNode"
                               icon="/images/icn_tree_Platform.gif"
                               nodeFace="#{treeNode.data.class.simpleName}">
                        
                        <rich:recursiveTreeNodesAdaptor roots="#{ResourceGroupTreeModelUIBean.roots}" var="groupTreeItem"
                                                        nodes="#{groupTreeItem.nodes}">


                        </rich:recursiveTreeNodesAdaptor>


                        <rich:treeNode type="ResourceGroup"
                                       iconLeaf="/images/icn_tree_folder.gif" icon="/images/icn_tree_folder.gif">
                            <h:outputText value="#{groupTreeItem}"/>

                        </rich:treeNode>


                        <rich:treeNode type="ResourceWithAvailability"
                                       icon="/images/icn_tree_#{groupTreeItem.data.resource.resourceType.category}.gif"
                                       iconLeaf="/images/icn_tree_#{groupTreeItem.data.resource.resourceType.category}.gif">


                            <a4j:support event="oncontextmenu" reRender="resourceMenu" timeout="5000">
                                <f:param name="contextResourceId" value="#{groupTreeItem.data.resource.id}"/>
                                <f:param name="contextResourceTypeId" value="#{groupTreeItem.data.resource.resourceType.id}"/>

                                <rich:componentControl disableDefault="true" event="oncomplete" for="resourceMenu"
                                                       operation="show">
                                    <f:param value="#{groupTreeItem.data.resource.name}" name="name"/>
                                    <f:param value="#{groupTreeItem.data.resource.id}" name="id"/>
                                    <f:param value="#{groupTreeItem.data.resource.resourceType.name}" name="type"/>
                                    <f:param value="'#{groupTreeItem.data.resource.resourceType.operationDefinitions}'"
                                             name="ops"/>
                                </rich:componentControl>
                            </a4j:support>


                            <h:outputText value="#{groupTreeItem}"/>
                        </rich:treeNode>


                    </rich:tree>



            </h:form>



        <!--<a4j:log popup="false" level="WARN" style="width: 800px; height: 300px;"></a4j:log>-->


        <rich:contextMenu attached="false" id="resourceMenu" binding="#{ResourceTreeModelUIBean.menu}" disableDefaultMenu="true">

        </rich:contextMenu>


        <a4j:status id="localstatus" onstart="document.body.style.cursor = 'wait'">
                        <f:facet name="start">
                            <h:graphicImage value="/images/status_bar.gif"/>
                        </f:facet>
                    </a4j:status>

        </a4j:region>
    </h:form>

          </ui:composition>

</f:view>


</body>

</html>
