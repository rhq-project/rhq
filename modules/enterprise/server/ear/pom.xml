<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>org.rhq</groupId>
        <artifactId>rhq-parent</artifactId>
        <version>4.12.0-SNAPSHOT</version>
        <relativePath>../../../../pom.xml</relativePath>
    </parent>

    <artifactId>rhq-enterprise-server-ear</artifactId>
    <packaging>ear</packaging>

    <name>RHQ Enterprise Server EAR</name>
    <description>RHQ enterprise server EAR</description>

    <properties>
        <earDirectory>${project.build.directory}/${project.build.finalName}</earDirectory>
    </properties>

    <dependencies>

        <!-- Internal Deps -->

        <!-- ** EJB-JARs -->
        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>rhq-enterprise-server</artifactId>
            <version>${project.version}</version>
            <type>ejb</type>
        </dependency>

        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>rhq-core-domain</artifactId>
            <version>${project.version}</version>
            <type>ejb</type>
        </dependency>

        <!-- ** WARs -->
        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>rhq-portal</artifactId>
            <version>${project.version}</version>
            <type>war</type>
        </dependency>

        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>rhq-remote-client-war</artifactId>
            <version>${project.version}</version>
            <type>war</type>
        </dependency>

        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>rhq-downloads-war</artifactId>
            <version>${project.version}</version>
            <type>war</type>
        </dependency>

        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>rhq-agentupdate-war</artifactId>
            <version>${project.version}</version>
            <type>war</type>
        </dependency>


        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>rhq-coregui</artifactId>
            <version>${project.version}</version>
            <type>war</type>
        </dependency>

        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>rhq-rest</artifactId>
            <version>${project.version}</version>
            <type>war</type>
        </dependency>

        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>rhq-rest-examples</artifactId>
            <version>${project.version}</version>
            <type>war</type>
        </dependency>

        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>rhq-remoting-war</artifactId>
            <version>${project.version}</version>
            <type>war</type>
        </dependency>

        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>rhq-content_http</artifactId>
            <version>${project.version}</version>
            <type>war</type>
        </dependency>

        <!-- ** JARs -->
        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>rhq-script-bindings</artifactId>
            <version>${project.version}</version>
            <exclusions>
                <exclusion>
                    <groupId>${project.groupId}</groupId>
                    <artifactId>rhq-core-domain</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>javassist</groupId>
                    <artifactId>javassist</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>org.javassist</groupId>
                    <artifactId>javassist</artifactId>
                </exclusion>
            </exclusions>
        </dependency>

        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>rhq-scripting-javascript</artifactId>
            <version>${project.version}</version>
        </dependency>

        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>rhq-server-client-api</artifactId>
            <version>${project.version}</version>
            <exclusions>
                <exclusion>
                    <groupId>${project.groupId}</groupId>
                    <artifactId>rhq-enterprise-server</artifactId>
                </exclusion>
            </exclusions>
        </dependency>

        <dependency>
            <groupId>${project.groupId}</groupId>
            <artifactId>rhq-enterprise-comm</artifactId>
            <version>${project.version}</version>
            <exclusions>
                <exclusion>
                    <groupId>dom4j</groupId>
                    <artifactId>dom4j</artifactId>
                </exclusion>
                <exclusion>
                    <groupId>org.jboss</groupId>
                    <artifactId>jboss-common-core</artifactId>
                </exclusion>
            </exclusions>
        </dependency>

        <dependency>
            <groupId>org.rhq.helpers</groupId>
            <artifactId>rhq-rtfilter</artifactId>
            <version>${project.version}</version>
        </dependency>

        <!-- 3rd Party Deps -->

        <!-- ** WARs -->

        <!-- none -->

        <!-- ** JARs -->
        <dependency>
            <groupId>org.opensymphony.quartz</groupId>
            <artifactId>quartz</artifactId>
        </dependency>

        <dependency>
            <groupId>org.opensymphony.quartz</groupId>
            <artifactId>quartz-oracle</artifactId>
            <version>${quartz.version}</version>
        </dependency>

        <dependency>
            <groupId>postgresql</groupId>
            <artifactId>postgresql</artifactId>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>org.jboss.resteasy</groupId>
            <artifactId>resteasy-jaxrs</artifactId>
            <version>${resteasy.version}</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.jboss.resteasy</groupId>
            <artifactId>resteasy-jackson-provider</artifactId>
            <version>${resteasy.version}</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.jboss.resteasy</groupId>
            <artifactId>resteasy-links</artifactId>
            <version>${resteasy.version}</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.freemarker</groupId>
            <artifactId>freemarker</artifactId>
        </dependency>
        <dependency>
            <groupId>org.jboss.resteasy</groupId>
            <artifactId>resteasy-yaml-provider</artifactId>
            <version>${resteasy.version}</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>org.yaml</groupId>
            <artifactId>snakeyaml</artifactId>
            <version>1.8</version>
        </dependency>
        <dependency>
            <groupId>org.jboss.resteasy</groupId>
            <artifactId>resteasy-jaxb-provider</artifactId>
            <version>${resteasy.version}</version>
            <scope>provided</scope>
        </dependency>

    </dependencies>

    <build>
        <finalName>rhq</finalName>

        <plugins>

            <plugin>
              <artifactId>maven-ear-plugin</artifactId>

                <!-- if adding new module here, please add it to 'enable-rha' profile as well -->  

                <configuration>
                    <version>6</version> <!-- version of the generated application.xml -->
                    <displayName>RHQ</displayName>
                    <workDirectory>${earDirectory}</workDirectory>
                    <filtering>true</filtering>
                    <defaultJavaBundleDir>lib</defaultJavaBundleDir>
                    <unpackTypes>war,ejb</unpackTypes>
                    <initializeInOrder>true</initializeInOrder>
                    <modules>
                        <!-- ** EJB-JARs -->
                        <ejbModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-core-domain</artifactId>
                            <bundleFileName>rhq-core-domain-ejb3.jar</bundleFileName>
                        </ejbModule>

                        <ejbModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-enterprise-server</artifactId>
                            <bundleFileName>rhq-server.jar</bundleFileName>
                        </ejbModule>

                        <ejbClientModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-enterprise-server</artifactId>
                            <excluded>true</excluded>
                        </ejbClientModule>

                        <!-- ** JARs -->
                        <jarModule>
                            <groupId>org.rhq.helpers</groupId>
                            <artifactId>rhq-rtfilter</artifactId>
                            <bundleDir>lib</bundleDir>
                            <includeInApplicationXml>false</includeInApplicationXml>
                        </jarModule>

                        <!-- ** WARs -->
                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-portal</artifactId>
                            <bundleFileName>rhq-portal.war</bundleFileName>
                            <contextRoot>/portal</contextRoot>
                        </webModule>

                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-remote-client-war</artifactId>
                            <bundleFileName>rhq-client.war</bundleFileName>
                            <contextRoot>/client</contextRoot>
                        </webModule>

                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-downloads-war</artifactId>
                            <bundleFileName>rhq-downloads.war</bundleFileName>
                            <contextRoot>/downloads</contextRoot>
                        </webModule>

                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-agentupdate-war</artifactId>
                            <bundleFileName>rhq-agentupdate.war</bundleFileName>
                            <contextRoot>/agentupdate</contextRoot>
                        </webModule>

                        <!-- used to expose content through http -->
                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-content_http</artifactId>
                            <excluded>${exclude-content_http}</excluded>
                            <bundleFileName>rhq-content_http.war</bundleFileName>
                            <contextRoot>/content</contextRoot>
                        </webModule>

                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-rest</artifactId>
                            <bundleFileName>rhq-rest.war</bundleFileName>
                            <contextRoot>/rest</contextRoot>
                        </webModule>

                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-rest-examples</artifactId>
                            <bundleFileName>rhq-rest-examples.war</bundleFileName>
                            <contextRoot>/rest-examples</contextRoot>
                        </webModule>

                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-remoting-war</artifactId>
                            <bundleFileName>rhq-remoting.war</bundleFileName>
                            <contextRoot>/jboss-remoting-servlet-invoker</contextRoot>
                        </webModule>

                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-coregui</artifactId>
                            <bundleFileName>coregui.war</bundleFileName>
                            <contextRoot>/coregui</contextRoot>
                        </webModule>

                    </modules>
                </configuration>
            </plugin>

            <plugin>
                <artifactId>maven-dependency-plugin</artifactId>
                <executions>

                    <execution>
                        <id>copy-core-agent-plugins</id>
                        <phase>process-resources</phase>
                        <goals>
                            <goal>copy</goal>
                        </goals>
                        <configuration>
                            <artifactItems>
                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>rhq-platform-plugin</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>rhq-agent-plugin</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>rhq-jmx-plugin</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>rhq-ant-bundle-plugin</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>rhq-filetemplate-bundle-plugin</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>rhq-cassandra-plugin</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>rhq-rhqstorage-plugin</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>
                            </artifactItems>
                            <outputDirectory>${earDirectory}/rhq-downloads/rhq-plugins</outputDirectory>
                        </configuration>
                    </execution>

                    <execution>
                        <id>copy-core-server-plugins</id>
                        <phase>process-resources</phase>
                        <goals>
                            <goal>copy</goal>
                        </goals>
                        <configuration>
                            <artifactItems>
                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>rhq-serverplugin-ant-bundle</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>rhq-serverplugin-filetemplate-bundle</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>rhq-serverplugin-disk</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>rhq-serverplugin-url</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>rhq-serverplugin-yum</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}.server</groupId>
                                    <artifactId>alert-email</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>alert-irc</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>alert-mobicents</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>alert-microblog</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>alert-operations</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>alert-roles</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>alert-snmp</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>alert-subject</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>alert-cli</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>packagetype-cli</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>serverplugin-alertdef-rhq</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>

                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>rhq-serverplugin-drift</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>
                                
                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>rhq-serverplugin-jdr</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>


                                <!-- TODO:jdk6 - temporarily disabled because of jdk6 requirement
                                <artifactItem>
                                    <groupId>${project.groupId}</groupId>
                                    <artifactId>alert-scriptlang</artifactId>
                                    <version>${project.version}</version>
                                </artifactItem>
                                -->

                            </artifactItems>
                            <outputDirectory>${earDirectory}/rhq-serverplugins</outputDirectory>
                        </configuration>
                    </execution>

                </executions>
            </plugin>
        </plugins>
    </build>

    <profiles>
        <profile>
          <id>enable-rha</id>
           <activation>
              <property>
                 <!-- we want this always active but activeByDefault doesn't work -->
                 <!-- see http://maven.apache.org/guides/introduction/introduction-to-profiles.html -->
                 <name>java.home</name>
              </property>
           </activation>
            <dependencies>
              <dependency>
                <groupId>${project.groupId}</groupId>
                <artifactId>rhq-rh-access</artifactId>
                <version>${project.version}</version>
                <type>war</type>
              </dependency>
            </dependencies>
            <build>
        <plugins>
            <plugin>
                <artifactId>maven-ear-plugin</artifactId>
                <configuration>
                    <version>6</version> <!-- version of the generated application.xml -->
                    <displayName>RHQ</displayName>
                    <workDirectory>${earDirectory}</workDirectory>
                    <filtering>true</filtering>
                    <defaultJavaBundleDir>lib</defaultJavaBundleDir>
                    <unpackTypes>war,ejb</unpackTypes>
                    <initializeInOrder>true</initializeInOrder>
                    <modules>
                        <!-- ** EJB-JARs -->
                        <ejbModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-core-domain</artifactId>
                            <bundleFileName>rhq-core-domain-ejb3.jar</bundleFileName>
                        </ejbModule>

                        <ejbModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-enterprise-server</artifactId>
                            <bundleFileName>rhq-server.jar</bundleFileName>
                        </ejbModule>

                        <ejbClientModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-enterprise-server</artifactId>
                            <excluded>true</excluded>
                        </ejbClientModule>

                        <!-- ** JARs -->
                        <jarModule>
                            <groupId>org.rhq.helpers</groupId>
                            <artifactId>rhq-rtfilter</artifactId>
                            <bundleDir>lib</bundleDir>
                            <includeInApplicationXml>false</includeInApplicationXml>
                        </jarModule>
                        <!-- ** WARs -->
                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-portal</artifactId>
                            <bundleFileName>rhq-portal.war</bundleFileName>
                            <contextRoot>/portal</contextRoot>
                        </webModule>

                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-remote-client-war</artifactId>
                            <bundleFileName>rhq-client.war</bundleFileName>
                            <contextRoot>/client</contextRoot>
                        </webModule>

                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-downloads-war</artifactId>
                            <bundleFileName>rhq-downloads.war</bundleFileName>
                            <contextRoot>/downloads</contextRoot>
                        </webModule>

                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-agentupdate-war</artifactId>
                            <bundleFileName>rhq-agentupdate.war</bundleFileName>
                            <contextRoot>/agentupdate</contextRoot>
                        </webModule>

                        <!-- used to expose content through http -->
                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-content_http</artifactId>
                            <excluded>${exclude-content_http}</excluded>
                            <bundleFileName>rhq-content_http.war</bundleFileName>
                            <contextRoot>/content</contextRoot>
                        </webModule>

                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-rest</artifactId>
                            <bundleFileName>rhq-rest.war</bundleFileName>
                            <contextRoot>/rest</contextRoot>
                        </webModule>

                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-rest-examples</artifactId>
                            <bundleFileName>rhq-rest-examples.war</bundleFileName>
                            <contextRoot>/rest-examples</contextRoot>
                        </webModule>

                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-remoting-war</artifactId>
                            <bundleFileName>rhq-remoting.war</bundleFileName>
                            <contextRoot>/jboss-remoting-servlet-invoker</contextRoot>
                        </webModule>

                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-coregui</artifactId>
                            <bundleFileName>coregui.war</bundleFileName>
                            <contextRoot>/coregui</contextRoot>
                        </webModule>

                        <webModule>
                            <groupId>${project.groupId}</groupId>
                            <artifactId>rhq-rh-access</artifactId>
                            <bundleFileName>rhq-rh-access.war</bundleFileName>
                            <contextRoot>/rha</contextRoot>
                        </webModule>
                     </modules>
                  </configuration>
              </plugin>
            </plugins> 
          </build>
        </profile>

        <!-- NOTE: this profile HAS TO have the same activation policy as the profile with the same name in the root pom.xml of RHQ -->
        <profile>
           <id>bundle-additional-script-languages</id>
           <activation>
              <property>
                 <!-- we want this always active but activeByDefault doesn't work -->
                 <!-- see http://maven.apache.org/guides/introduction/introduction-to-profiles.html -->
                 <name>java.home</name>
              </property>
           </activation>

           <dependencies>
              <dependency>
                 <groupId>org.rhq</groupId>
                 <artifactId>rhq-scripting-python</artifactId>
                 <version>${project.version}</version>
              </dependency>
           </dependencies>
        </profile>

        <profile>
            <id>jboss-plugins</id>
            <activation>
                <property>
                    <name>java.home</name>
                </property>
            </activation>

            <build>
                <plugins>
                    <plugin>
                        <artifactId>maven-dependency-plugin</artifactId>
                        <executions>

                            <execution>
                                <id>copy-jboss-plugins</id>
                                <phase>process-resources</phase>
                                <goals>
                                    <goal>copy</goal>
                                </goals>
                                <configuration>
                                    <artifactItems>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-augeas-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-apache-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>org.jboss.on</groupId>
                                            <artifactId>jopr-tomcat-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>org.jboss.on</groupId>
                                            <artifactId>jopr-jboss-as-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>org.jboss.on</groupId>
                                            <artifactId>jopr-hibernate-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>org.rhq</groupId>
                                            <artifactId>rhq-rhqserver-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>org.jboss.on</groupId>
                                            <artifactId>jopr-jboss-cache-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>org.jboss.on</groupId>
                                            <artifactId>jopr-jboss-as-5-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>org.jboss.on</groupId>
                                            <artifactId>jopr-jboss-cache-v3-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>modcluster-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-jboss-as-7-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>
                                    </artifactItems>
                                    <outputDirectory>${earDirectory}/rhq-downloads/rhq-plugins</outputDirectory>
                                </configuration>
                            </execution>

                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>

        <profile>
            <id>linux-plugins</id>
            <activation>
                <property>
                    <name>java.home</name>
                </property>
            </activation>

            <build>
                <plugins>
                    <plugin>
                        <artifactId>maven-dependency-plugin</artifactId>
                        <executions>

                            <execution>
                                <id>copy-linux-plugins</id>
                                <phase>process-resources</phase>
                                <goals>
                                    <goal>copy</goal>
                                </goals>
                                <configuration>
                                    <artifactItems>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-augeas-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-cron-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-script-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-grub-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-hosts-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-cobbler-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-sudoers-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-netservices-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-samba-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-postfix-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-aliases-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-sshd-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <!-- TODO:jdk6 - temporarily disabled because of jdk6 requirement
                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-script2-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>
                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-virt-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>
                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-kickstart-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>
                                        -->
                                    </artifactItems>
                                    <outputDirectory>${earDirectory}/rhq-downloads/rhq-plugins</outputDirectory>
                                </configuration>
                            </execution>

                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>

        <profile>
            <id>misc-plugins</id>
            <activation>
                <property>
                    <name>java.home</name>
                </property>
            </activation>

            <build>
                <plugins>
                    <plugin>
                        <artifactId>maven-dependency-plugin</artifactId>
                        <executions>

                            <execution>
                                <id>copy-misc-plugins</id>
                                <phase>process-resources</phase>
                                <goals>
                                    <goal>copy</goal>
                                </goals>
                                <configuration>
                                    <artifactItems>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-hudson-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-iis-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-database-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-postgres-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-mysql-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-oracle-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-perftest-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-snmptrapd-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-twitter-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                        <artifactItem>
                                            <groupId>${project.groupId}</groupId>
                                            <artifactId>rhq-filetemplate-bundle-plugin</artifactId>
                                            <version>${project.version}</version>
                                        </artifactItem>

                                    </artifactItems>
                                    <outputDirectory>${earDirectory}/rhq-downloads/rhq-plugins</outputDirectory>
                                </configuration>
                            </execution>

                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>

        <profile>
            <id>dev</id>

            <properties>
                <rhq.rootDir>../../../..</rhq.rootDir>
                <rhq.containerDir>${rhq.rootDir}/${rhq.devContainerServerPath}</rhq.containerDir>
                <rhq.deploymentName>${project.build.finalName}.ear</rhq.deploymentName>
                <rhq.deploymentDir>${rhq.containerDir}/modules/org/rhq/server-startup/main/deployments/${rhq.deploymentName}</rhq.deploymentDir>
            </properties>

            <build>
                <plugins>

                    <plugin>
                        <artifactId>maven-antrun-plugin</artifactId>
                        <executions>

                            <execution>
                                <id>deploy</id>
                                <phase>package</phase>
                                <configuration>
                                    <target>
                                        <property name="deployment.dir" location="${rhq.deploymentDir}" />
                                        <echo>*** Copying updated files from
                                            target${file.separator}${project.build.finalName}${file.separator}
                                            to
                                            ${deployment.dir}${file.separator}...</echo>
                                        <copy todir="${deployment.dir}" verbose="${rhq.verbose}">
                                            <fileset dir="${basedir}/target/${project.build.finalName}" />
                                        </copy>
                                    </target>
                                </configuration>
                                <goals>
                                    <goal>run</goal>
                                </goals>
                            </execution>

                            <execution>
                                <id>deploy-ear-meta-inf</id>
                                <phase>package</phase>
                                <configuration>
                                    <target>
                                        <unjar src="${project.build.directory}/${project.build.finalName}.ear"
                                               dest="${rhq.deploymentDir}">
                                            <patternset>
                                                <include name="META-INF/**" />
                                            </patternset>
                                        </unjar>
                                    </target>
                                </configuration>
                                <goals>
                                    <goal>run</goal>
                                </goals>
                            </execution>

                            <execution>
                                <id>undeploy</id>
                                <phase>clean</phase>
                                <configuration>
                                    <target>
                                        <property name="deployment.dir" location="${rhq.deploymentDir}" />
                                        <echo>*** Deleting ${deployment.dir}${file.separator}...</echo>
                                        <delete dir="${deployment.dir}" />
                                    </target>
                                </configuration>
                                <goals>
                                    <goal>run</goal>
                                </goals>
                            </execution>

                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>

    </profiles>

</project>

