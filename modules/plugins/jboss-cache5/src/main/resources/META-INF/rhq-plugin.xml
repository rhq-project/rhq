<?xml version="1.0" encoding="UTF-8" ?>

<plugin name="JBossCache5"
        displayName="JBossCache5 Services"
        package="org.rhq.plugins.jbosscache5"
        description="Provides monitoring of JBossCache 5.x statistics"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="urn:xmlns:rhq-plugin"
        xmlns:c="urn:xmlns:rhq-configuration">

   <depends plugin="JMX" />
   <depends plugin="JBossAS5" useClasses="true"/>

   <service name="JBoss Cache"
            class="JBossCacheComponent"
            discovery="JBossCacheDiscoveryComponent"
            description="The JBoss Cache instances on this server">  
           
          <runs-inside>
             <parent-resource-type name="JBossAS Server" plugin="JBossAS5"/>
          </runs-inside>
                 
          <plugin-configuration>
              <c:simple-property name="service" default="service=Cache"/>
              <c:simple-property name="domain" default="jboss.cache"/>
              <c:simple-property name="config" default="config=*"/>
              <c:simple-property name="jmx-resource" default="jmx-resource=*"/>
          </plugin-configuration>
           
           <operation name="destroy" displayName="destroy"/>         
           <operation name="stop" displayName="stop"/>         
           <operation name="create" displayName="create"/>         
           <operation name="start" displayName="start"/>         
           <operation name="printLockInfo" displayName="Print Lock Info">
                  <results><c:simple-property name="details"></c:simple-property></results>
            </operation>
            <operation name="printCacheDetails" displayName="Print Cache Details" >
                  <results><c:simple-property name="details"></c:simple-property></results>
             </operation>    
            <operation name="printCacheDetailsAsHtml" displayName="print Cache Details As Html">
                  <results><c:simple-property name="details"></c:simple-property></results>
             </operation>  
            <operation name="printConfigurationAsString" displayName="print Configuration As String.">
                  <results><c:simple-property name="details"></c:simple-property></results>
             </operation>  
            <operation name="printLockInfoAsHtml" displayName="print Configuration As String">
                  <results><c:simple-property name="details"></c:simple-property></results>
             </operation>  
             <operation name="printConfigurationAsHtmlString" displayName="Print Details as HTML.">
                  <results><c:simple-property name="details"></c:simple-property></results>
             </operation> 
          
            <metric property="LocalAddress" dataType="trait" displayType="summary" />       
            <metric property="ClusterConfig" dataType="trait" />       
            <metric property="NodeLockingScheme" dataType="trait" />       
            <metric property="Members" dataType="trait" />         
            <metric property="ExposeManagementStatistics" dataType="trait" displayName="Expose Management Statistics?" />       
            <metric property="RegisterJmxResource" dataType="trait" displayName="Register JMX Resource?" />       
            <metric property="CacheLoaderConfiguration" dataType="trait" />       
            <metric property="MultiplexerStack" dataType="trait" />       
            <metric property="ReplQueueMaxElements"  displayName="Replication Queue Max Elements" category="performance"/>       
            <metric property="NumberOfAttributes"  displayName="Number of Attributes" category="performance"/>       
            <metric property="CacheLoaderConfig" dataType="trait" />       
            <metric property="ClusterName" dataType="trait" />       
            <metric property="InactiveOnStartup"  dataType="trait" displayName="Inactive on Startup?" />       
            <metric property="CacheMode" dataType="trait" />            
            <metric property="IsolationLevel" dataType="trait" />       
            <metric property="ReplicationVersion" dataType="trait" />       
            <metric property="FetchInMemoryState" dataType="trait" displayName="Fetch In-Memory State?" />       
            <metric property="InitialStateRetrievalTimeout" category="performance"/>       
            <metric property="BuddyReplicationConfig" dataType="trait" />       
            <metric property="ReplQueueInterval"  displayName="Replication Queue Interval" category="performance"/>       
            <metric property="UseReplQueue" dataType="trait" displayName="Use Replication Queue?" />       
            <metric property="UseRegionBasedMarshalling" dataType="trait" displayName="Use Region-Based Marshalling?" />                   
            <metric property="LockAcquisitionTimeout"  displayName="Lock Acquisition Timeout" category="performance" />       
            <metric property="NumberOfNodes"  displayName="Number of Nodes" category="performance"/>       
            <metric property="CacheStatus" dataType="trait" />       
            <metric property="SyncCommitPhase" dataType="trait" displayName="Sync Commit Phase?" />       
            <metric property="SyncReplTimeout" displayName="Sync Replication Timeout" category="performance"/>       
            <metric property="EvictionPolicyConfig" dataType="trait" />       
            <metric property="State" dataType="trait" />       
            <metric property="StateRetrievalTimeout" category="performance"/>             
            <metric property="TransactionManagerLookupClass" dataType="trait" />       
            <metric property="ClusterProperties" dataType="trait" />       
                                                 
          <service name="Interceptor"
                   class="JBossCacheDetailComponent"
                   discovery="JBossCacheDetailDiscoveryComponent"
                   description="JBoss Cache Interceptor">
             
              <plugin-configuration>
                <c:simple-property name="jmx-resource" default="jmx-resource=CacheMgmtInterceptor"/>
              </plugin-configuration>
               
               <operation name="resetStatistics" displayName="Reset Statistics" description="Resets all statistics" />
                
               <metric property="Evictions"  displayName="Evictions" measurementType="trendsup"
                  description="number of cache eviction operations"  category="performance"/>
               <metric property="HitMissRatio"  displayName="Hit/Miss Ratio" displayType="summary" />
               <metric property="ReadWriteRatio"  displayName="Read/Write Ratio" displayType="summary" />
               <metric property="NumberOfNodes"  displayName="NumberOfNodes" 
                  description="number of nodes in the cache"  category="performance"/>
               <metric property="Hits"  displayName="Hits" measurementType="trendsup"
                  description="number of cache attribute hits"  category="performance"/>
               <metric property="NumberOfAttributes"
                  description="umber of cache attributes"  category="performance"/>
               <metric property="StatisticsEnabled"  dataType="trait" />
               <metric property="ElapsedTime"
                   description="seconds since cache started"  category="utilization" measurementType="trendsup"
                   units="seconds"/>
               <metric property="TimeSinceReset" category="utilization" 
                   description="number of seconds since the cache statistics were last reset"
                   measurementType="trendsup" units="seconds"/>
               <metric property="Misses" measurementType="trendsup"
                   description="number of cache attribute misses"/>
               <metric property="AverageWriteTime" units="milliseconds"
                   description="average number of milliseconds for a write operation"  category="performance"/>
               <metric property="Stores" measurementType="trendsup" 
                   description="number of cache attribute put operations"  category="performance"/>
               <metric property="AverageReadTime" units="milliseconds"
                   description="average number of milliseconds for a read operation"  category="performance"/>
               
           </service>    
            
           <service name="Data Container"
                    class="JBossCacheDetailComponent"
                    discovery="JBossCacheDetailDiscoveryComponent"
                    description="JBoss Cache Data Container">
             
              <plugin-configuration>
                <c:simple-property name="jmx-resource" default="jmx-resource=CacheMgmtInterceptor"/>
              </plugin-configuration>     
              
                <operation name="getNumberOfNodes" displayName="Get Number of nodes." description="Returns the number of nodes in the data container">
                  <results><c:simple-property name="nr"></c:simple-property></results>
                </operation>
                <operation name="getNumberOfAttributes" displayName="Get Number of attributes." description="Returns the number of nodes in the data container">
                  <results><c:simple-property name="nr"></c:simple-property></results>
                </operation>
                <operation name="printDetails" displayName="Print Details." description="Prints details of the data container">
                  <results><c:simple-property name="details"></c:simple-property></results>
                </operation>
                <operation name="printDetailsAsHtml" displayName="Print Details as HTML." description="Prints details of the data container, formatted as an HTML String">
                  <results><c:simple-property name="details"></c:simple-property></results>
                </operation>       
                           
           </service>

           <service name="RPC Manager"
                    class="JBossCacheDetailComponent"
                    discovery="JBossCacheDetailDiscoveryComponent"
                    description="JBoss Cache RPC Manager">

              <plugin-configuration>
                <c:simple-property name="jmx-resource" default="jmx-resource=RPCManager"/>
              </plugin-configuration>   
                    
              <operation name="resetStatistics" displayName="Reset Statistics" description="Resets all statistics" />
                    
               <metric property="Enabled" dataType="trait"  displayName="RPC Enabled?" 
                 description="whether or not the RPC Manager is used in this cache instance"/>
               <metric property="ReplicationFailures" displayName="Failed Replications" 
                 description="number of failed replications"/>
               <metric property="LocalAddressString" dataType="trait" displayName="Local Address" 
                 description="Local address"/>
               <metric property="StatisticsEnabled" dataType="trait" />
               <metric property="ReplicationCount" displayName="Successful Replications"  
                 description="number of successful replications"/>
               <metric property="SuccessRatio" dataType="trait"
                 description="RPC call success ratio"/>
               <metric property="MembersString" dataType="trait" displayName="Members" 
                 description="Cluster view"/>
                 
           </service>
           
           <service name="Region Manager"
                    class="JBossCacheDetailComponent"
                    discovery="JBossCacheDetailDiscoveryComponent"
                    description="JBoss Cache RegionManager">

              <plugin-configuration>
                <c:simple-property name="jmx-resource" default="jmx-resource=RegionManager"/>
              </plugin-configuration>              
               
             <operation name="dumpRegions" displayName="Dump Regions" description="A String representation of all registered regions">
                <results><c:simple-property name="dump"></c:simple-property></results>
             </operation>
             
             <metric property="numRegions"  displayName="Number of Regions" 
                 description="A count of all regions"  category="performance"/>               
           </service>

           <service name="Transaction Table"
                    class="JBossCacheDetailComponent"
                    discovery="JBossCacheDetailDiscoveryComponent"
                    description="JBoss Cache TransactionTable">
                 
              <plugin-configuration>
                <c:simple-property name="jmx-resource" default="jmx-resource=TransactionTable"/>
              </plugin-configuration>         
              <operation name="resetStatistics" displayName="Reset Statistics" description="Resets all statistics" />         
                   
              <metric property="numberOfRegisteredTransactions"
                description="Number of registered transactions"  category="performance"/>
              <metric property="transactionMap"  dataType="trait"
                description="A String representation of the transaction map"  />
           </service>

           <service name="Tx Interceptor"
                    class="JBossCacheDetailComponent"
                    discovery="JBossCacheDetailDiscoveryComponent"
                    description="JBoss Cache TxInterceptor">
                 
               <plugin-configuration>
                 <c:simple-property name="jmx-resource" default="jmx-resource=TxInterceptor"/>
               </plugin-configuration>              
            
               <metric property="Commits"
                description="number of transaction commits"  category="performance"/>       
               <metric property="StatisticsEnabled"  dataType="trait" displayName="Statistics Enabled?" 
                description="A String representation of the transaction map"  />       
               <metric property="Rollbacks"
                description="number of transaction rollbacks"  category="performance"/>        
               <metric property="Prepares"
                description="number of transaction prepares"  category="performance"/>       
               <metric property="numberOfSyncsRegistered"
                description="number of transaction synchronizations currently registered"  category="performance"/>       
           </service>     
         
    </service>
    
</plugin>
