<?xml version="1.0" encoding="UTF-8" ?>

<plugin name="mod_cluster"
        displayName="mod_cluster"
        version="1.0"
        package="org.rhq.plugins.modcluster"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="urn:xmlns:rhq-plugin"
        xmlns:c="urn:xmlns:rhq-configuration">

   <depends plugin="JMX" />

   <service name="mod_cluster"
           discovery="org.rhq.plugins.jmx.MBeanResourceDiscoveryComponent"
           class="ModclusterServerComponent"
           supportsManualAdd="true"
           description="mod_cluster plugin">
           
      <runs-inside>         
         <parent-resource-type name="JBossAS Server" plugin="JBossAS"/>
         <parent-resource-type name="JBossAS Server" plugin="JBossAS5"/>
      </runs-inside>
      
      <plugin-configuration>        
         <c:simple-property name="objectName" readOnly="true" default="Catalina:type=ModClusterListener,*"/>
         <c:simple-property name="nameTemplate" default="{application}"/>         
      </plugin-configuration>
      
      <operation name="reset" displayName="Reset the node" description="Move the node out of an error state" />
      <operation name="refresh" displayName="Refresh configuration" description="Refresh configuration" />
      <operation name="enable" displayName="Enable all webapps" description="Enable all webapps for all engines">
      	<results>
      		<c:simple-property name="result" type="boolean" description="The result of the operation" />
      	</results>
      </operation>
      <operation name="disable" displayName="Disable all webpapps" description="Disable all webapps for all engines">
      	<results>
      		<c:simple-property name="result" type="boolean" description="The result of the operation" />
      	</results>
      </operation>
      
      <metric property="proxyConfiguration" displayName="Proxy Configuration" displayType="summary" dataType="trait" />
      <metric property="modelerType" displayName="Type of the modeled resource" displayType="summary" dataType="trait" />
      <metric property="className" displayName="Fully qualified class name of the managed object" displayType="summary" dataType="trait" />
      
      <resource-configuration>
      	<c:simple-property name="stickySessions" type="boolean" description="Enables sticky sessions."/>
      </resource-configuration>
      
       <service name="mod_cluster_context"
         discovery="ContextDiscoveryComponent"
         class="ContextComponent"
         description="A mod_cluster context">

      	<operation name="enableContext" displayName="Enable webapp" description="Enable a single webapp">
      		<results>
      			<c:simple-property name="result" type="boolean" description="The result of the operation" />
      		</results>
      	</operation>
      	<operation name="disableContext" displayName="Disable webpapp" description="Disable a single webapp">
      		<results>
	      		<c:simple-property name="result" type="boolean" description="The result of the operation" />
      		</results>
      	</operation>
      	<operation name="stopContext" displayName="Stop webpapp" description="Gracefully stops a single webapp">
      		<results>
	      		<c:simple-property name="result" type="boolean" description="The result of the operation" />
      		</results>
      	</operation>

      </service>
      
      
   </service>
</plugin>
